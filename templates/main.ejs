<!DOCTYPE HTML>
<html lang="en">
<head>
    <%- include("./parts/head.ejs") %>
</head>
<body>
    <%- include("./parts/header.ejs") %>

    <% if((permissAccess === 'true') && (activee === 'active')) {%>
        <%- include("./parts/messeger-write.ejs") %> 

        <%- include("./parts/messeger.ejs") %> 
    <% } %>

    <%- include("./parts/settings.ejs") %> 
    <div class="wrap">  
        <div class="out1"></div>
        <div class="out2"></div>
        <div class="side">
            <%- include("./parts/info.ejs") %>

            <% if((permissEdit === 'true') && (vfriendme === 'on')) {%>
                <%- include("./parts/friendside.ejs") %>
            <% } %>
            <% if((permissEdit === 'false') && (vfriendall === 'on')) {%>
                <%- include("./parts/friendside.ejs") %>
            <% } %>


            <% if((permissEdit === 'true') && (vskillsme === 'on') && (vskillsmetop === 'off')) {%>
                <%- include("./parts/skillsside.ejs") %> 
            <% } %>
            <% if((permissEdit === 'false') && (vskillsall === 'on') && (vskillsalltop === 'off')) {%>
                <%- include("./parts/skillsside.ejs") %> 
            <% } %>


            <% if((permissEdit === 'true') && (vprojectsme === 'on') && (vprojectsmetop === 'off')) {%>
                <%- include("./parts/projectsside.ejs") %> 
            <% } %>
            <% if((permissEdit === 'false') && (vprojectsall === 'on') && (vprojectsalltop === 'off')) {%>
                <%- include("./parts/projectsside.ejs") %> 
            <% } %>
        </div>
        <div class="article">   
            <%- include("./parts/nav.ejs") %>  
            <%- include("./parts/article.ejs") %> 
        </div>
        <div class="blok">
            <%- include("./parts/ontopfooter.ejs") %>
        </div>       
    </div>
    <div class="footer-main-info reg-footer" style="color:#ffffff; background:#3e3e3e">
        <%- include("./parts/footer.ejs") %>
    </div>
    
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="./js/message.js"></script>
    <script src="./js/checkinputs.js"></script>
    <script src="./js/service.js"></script>
    <script src="./js/view.js"></script>
    <script src="./js/controller-main.js"></script>
    <script src="./js/skills.js"></script>
    <script src="./js/projects.js"></script>
    <script src="./js/friends.js"></script>
    <script src="./js/ava.js"></script>
    <script src="./js/messager.js"></script>

    <% if(permissEdit === 'true') {%>
        <script>
            // SE.$("reg-file").addEventListener("change", () => {VW.updateAva()});
            SE.send({"userid":window.location.href}, '/showprojects', WPROJ.showProjectsList);
            SE.send({"userid":window.location.href}, '/showskills', WSKILLS.showSkillsList);
        </script>
    <% } %>

    <!--friends-for-all-->
    <% if((vfriendall === 'on') && (permissEdit === 'false')) {%>
        <script>
            SE.send({"type":"friend", "limit":20, "step":''}, '/showfriends', WFRIENDS.showFriends);
        </script>
    <% } %>

    <!--friends-for-me-->
    <% if((vfriendme === 'on') && (permissEdit === 'true')) {%>
        <script>
            SE.send({"type":"friend", "limit":20, "step":''}, '/showfriends', WFRIENDS.showFriends);
        </script>
        <% if(permissEdit === 'true') {%>            
            <script>
                SE.send({"type":"reqto", "limit":200, "step":''}, '/showfriends', WFRIENDS.showFriendsAdd);            
                SE.send({"type":"reqfrom", "limit":200, "step":''}, '/showfriends', WFRIENDS.showFriendsProof);            
            </script>
        <% } %>
    <% } %>
    

    <!--skills-->
    <% if((permissEdit === 'false') && (vskillsall === 'on') && (vskillsalltop === 'off')) {%>
        <script>
            SE.send({"userid":window.location.href}, '/showskills', WSKILLS.showSkillsListForAll);
            setTimeout(() => {
                for (let i = 1; i <= 10; i++){
                    if (SE.$(`skills-box${i}`)){
                        SE.$(`skills-box${i}`).style.backgroundColor = "#f1f1f1";
                    }
                }
            },500);
        </script>
    <% } %>
    <% if((permissEdit === 'false') && (vskillsall === 'off') && (vskillsalltop === 'on')) {%>
        <script>
            SE.send({"userid":window.location.href}, '/showskills', WSKILLS.showSkillsListForAll);
            setTimeout(() => {
                for (let i = 1; i <= 10; i++){
                    if (SE.$(`skills-box${i}`)){
                        SE.$(`skills-box${i}`).style.backgroundColor = "#ffffff";
                    }
                }
            },500);  
        </script>
    <% } %>

    <!--projects-->
    <% if((permissEdit === 'false') && (vprojectsall === 'on') && (vprojectsalltop === 'off')) {%>
        <script>
            SE.send({"userid":window.location.href}, '/showprojects', WPROJ.showProjectsListAll);
            setTimeout(() => {
                for (let i = 1; i <= 10; i++){
                    if (SE.$(`progects-boks${i}`)){
                        SE.$(`progects-boks${i}`).style.backgroundColor = "#f1f1f1";
                    }
                }
            },500);        
        </script>
    <% } %>
    <% if((permissEdit === 'false') && (vprojectsall === 'off') && (vprojectsalltop === 'on')) {%>
        <script>
            SE.send({"userid":window.location.href}, '/showprojects', WPROJ.showProjectsListAll);
            setTimeout(() => {
                for (let i = 1; i <= 10; i++){
                    if (SE.$(`progects-boks${i}`)){
                        SE.$(`progects-boks${i}`).style.backgroundColor = "#ffffff";
                    }
                }
            },500);   
        </script>
    <% } %>



</body>
